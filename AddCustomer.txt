------------------------Functional Libraries--------------------------------
Function LaunchLoanApp()

    ' chk if login page exists 
    If Browser("Login - SmartBank LoanApp").Exist(2) Then 
    
    ' report to results page that app opens
        Reporter.ReportEvent micDone, "LoanApp", "LoanApp already opened."
        
        'chk if func passes
        LaunchLoanApp = True
        
    Else 
        'start multiple login system func for webloanapp
        SystemUtil.Run "Chrome.exe", "https://qa.hitekschool.com/lms/3108"
        
        Wait(3)
        
        'chk for login page again post opening, report to results and chk for passing
        If Browser("Login - SmartBank LoanApp").Exist(5) Then
            Reporter.ReportEvent micPass, "LoanApp", "LoanApp launched successfully."
            LaunchLoanApp = True
        Else
        
            'if multiple login attempts fail report to results page
            Reporter.ReportEvent micFail, "LoanApp", "LoanApp failed to launch."
            LaunchLoanApp = False
            
        End If
        
    End If
    
End Function

Sub Login(strLoginBN, strLoginUN, strLoginPWD)

    'edit branch name on login page
    Browser("Login - SmartBank LoanApp").Page("Login - SmartBank LoanApp").WebEdit("WebEdit_3").Set strLoginBN
    
    'edit user name on login page
    Browser("Login - SmartBank LoanApp").Page("Login - SmartBank LoanApp").WebEdit("WebEdit").Set strLoginUN
    
    'edit password on login page
    Browser("Login - SmartBank LoanApp").Page("Login - SmartBank LoanApp").WebEdit("WebEdit_2").Set strLoginPWD
    
    'edit remember me button on login page
    Browser("Login - SmartBank LoanApp").Page("Login - SmartBank LoanApp").WebCheckBox("WebCheckBox").Set "ON"
    
    'click sign in
    Browser("Login - SmartBank LoanApp").Page("Login - SmartBank LoanApp").WebButton("Sign in").Click
    
End Sub

Sub NavCustomers()

'Navigate to Customers link on Dashboard
    Browser("Login - SmartBank LoanApp").Page("SmartBank Dashboard -").Link("Customers").Click
    Wait(2)
    
    'Navigate to 'Add Customers' link on 'Customers' page
    Browser("Login - SmartBank LoanApp").Page("Customers - 'Tauranga'").Link("Add Customer").Click
    
    Wait(2)
    
End Sub

Sub FillInAddCustomer(strCustomerAccount, strCustomerFirstname, strCustomerLastname, strCustomerstreet, strCustomercity, strCustomerProvince, strCustomerPostal, strCustomerPhone, strCustomerEmail)
    
    'add Customer Account#
    Browser("Login - SmartBank LoanApp").Page("Add Customer - SmartBank").WebEdit("WebEdit").Set strCustomerAccount
    
    'add First Name
    Browser("Login - SmartBank LoanApp").Page("Add Customer - SmartBank").WebEdit("WebEdit_2").Set strCustomerFirstname
    
    'add Last Name
    Browser("Login - SmartBank LoanApp").Page("Add Customer - SmartBank").WebEdit("WebEdit_3").Set strCustomerLastname
    
    'add street
    Browser("Login - SmartBank LoanApp").Page("Add Customer - SmartBank").WebEdit("WebEdit_4").Set strCustomerstreet
    
    'add city
    Browser("Login - SmartBank LoanApp").Page("Add Customer - SmartBank").WebEdit("WebEdit_5").Set strCustomercity
    
    'select province
    Browser("Login - SmartBank LoanApp").Page("Add Customer - SmartBank").WebList("select").Select strCustomerProvince
    
    'add Postal code
    Browser("Login - SmartBank LoanApp").Page("Add Customer - SmartBank").WebEdit("WebEdit_6").Set strCustomerPostal
    
    'add Phone
    Browser("Login - SmartBank LoanApp").Page("Add Customer - SmartBank").WebEdit("WebEdit_7").Set strCustomerPhone
    
    'add Email
    Browser("Login - SmartBank LoanApp").Page("Add Customer - SmartBank").WebEdit("WebEdit_8").Set strCustomerEmail
    
    'click Save
    Browser("Login - SmartBank LoanApp").Page("Add Customer - SmartBank").WebButton("Save").Click
    
End Sub

Sub CloseandLogout()

'click on User Menu
    Browser("Login - SmartBank LoanApp").Page("Customers - 'Tauranga'").WebButton("User menu").Click
    
    'Click on Logout
    Browser("Login - SmartBank LoanApp").Page("Customers - 'Tauranga'").WebButton("Log out").Click
    
    'click close browser
    Browser("Login - SmartBank LoanApp").Close
    
    'report Logout
    Reporter.ReportEvent micDone, "Logout", "Application closed and logged out."
    
End Sub

Function AddCustomer(strCustomerAccount, strCustomerFirstname, strCustomerLastname, strCustomerstreet, strCustomercity, strCustomerProvince, strCustomerPostal, strCustomerPhone, strCustomerEmail)
    
    'chk if Login page launches or exit test
    If Not LaunchLoanApp() Then
        Reporter.ReportEvent micFail, "Test Flow", "Cannot continue â€“ LoanApp launch failed."
        ExitTest
    End If
    
   'Login
    Login "Tauranga", "admin", "sherwathe1122"
    
    'Navigate to Add Customers
    NavCustomers
    
    'Add Customer
    FillInAddCustomer strCustomerAccount, strCustomerFirstname, strCustomerLastname, strCustomerstreet, strCustomercity, strCustomerProvince, strCustomerPostal, strCustomerPhone, strCustomerEmail
    
    'chk for mandatory fields Account#, First name, Last name and if they are empty
    If strCustomerAccount <> "" AND strCustomerFirstname <> "" AND strCustomerLastname <> "" Then
    
    ' if fields are filled state that the result is valid using the validity function
        result = ValidCustomerCreation(strCustomerAccount)
    
    Else
      
      ' if fields are not filled state that the result is invalid using the invalidity function
        result = InvalidCustomerCreation(strCustomerAccount, strCustomerFirstname, strCustomerLastname)
    End If
    
    'close and logout
    CloseandLogout
    
   'assign pass/fail result of the function to 'Add Customer' field
    AddCustomer = result

End Function

Function ValidCustomerCreation(strCustomerAccount)

'declare result as a Dim variable
    Dim result
    
    'chk if 'FillInAddCustomer' function object created a new customer line on the 'Add Customer' page
    If Browser("Login - SmartBank LoanApp").Page("Customers - 'Tauranga'").WebElement("innerhtml:= " & strCustomerAccount).Exist(5) Then
    
        'report Account# exists on the Customers page
        Reporter.ReportEvent micPass, "New Customer Creation", "Customer '" & strCustomerAccount & "' exists"
        result = True
        
    Else
    
        'report Account# does not exist on the Customers page
        Reporter.ReportEvent micFail, "New Customer Creation", "Customer '" & strCustomerAccount & "' does not exist"
        result = False
        
    End If
    
    'assign the variable result's True/ False status to the function
    ValidCustomerCreation = result
    
End Function

Function InvalidCustomerCreation(strCustomerAccount, strCustomerFirstname, strCustomerLastname)

'declare result as a Dim variable
    Dim result
    
    'declare result as False
    result = False
    
'chk if strCustomerAccount is empty
    If strCustomerAccount = "" Then
    
    'chk if the strCustomerAccount is empty or has a value
        If Browser("Login - SmartBank LoanApp").Page("Add Customer - SmartBank").WebElement("innerhtml:= The 'Account #' field is required.").Exist(5) Then
            Reporter.ReportEvent micPass, "Invalid Input Validation", "Error for missing Account # appears"
            result = True
        End If
         
         'chk if the strCustomerFirstname is empty or has a value
    ElseIf strCustomerFirstname = "" Then
        If Browser("Login - SmartBank LoanApp").Page("Add Customer - SmartBank").WebElement("innerhtml:= The 'First Name' field is required.").Exist(5) Then
            Reporter.ReportEvent micPass, "Invalid Input Validation", "Error for missing First Name appears"
            result = True
        End If
         
         'chk if the strCustomerLastname is empty or has a value
    ElseIf strCustomerLastname = "" Then
        If Browser("Login - SmartBank LoanApp").Page("Add Customer - SmartBank").WebElement("innerhtml:= The 'Last Name' field is required.").Exist(5) Then
            Reporter.ReportEvent micPass, "Invalid Input Validation", "Error for missing Last Name appears"
            result = True
        End If
    Else
        
        'Report the case of Invalid result
        Reporter.ReportEvent micFail, "Invalid Input Validation", "Expected error message not displayed"
    End If

    'Assign  result variable value to the InvalidCustomerCreation function
    InvalidCustomerCreation = result
    
End Function

____________________________________________________________________________
Actual Script
____________________________________________________________________________

// Valid Input
AddCustomer "5623159", "John", "Herv", "1100SunsetBlvd", "Edson", "Alberta", "T7L1C8", "(588)469-1234", "jr@sample.com"

____________________________________________________________________________